<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Timeline - main</title>
    <link rel="stylesheet" href="/css/common.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.7.7/handlebars.min.js"></script>
    <style>
        .mainProfile {
            width: 600px;
            height: 200px;
            overflow: hidden;
        }

        .mprofBackground img {
            min-width: 100%;
            min-height: 100%;
            background-color: #448AC6;
            filter: blur(3px);
        }

        main {
            min-height: 1000px;
        }

        .viewBtn.active .optionBox {
            display: flex;
        }

        .optionBox.optionBoxColor li * {
            color: #595959;
        }
    </style>
</head>
<body>
<div class="wrap">
    <header>
        <div class="profile">
            <button class="optionBtn"><img src="/image/icon_option.png" alt="프로필 옵션 버튼"></button>
            <ul class="optionBox">
                <li><a>프로필 수정</a></li>
                <li><a>공유</a></li>
            </ul>
            <div class="profileStatus">
                <div class="prof_photo"><img src="/image/icon_no_image_lg.png" alt="프로필 사진"></div>
                <div class="prof_txt">
                    <strong>닉네임</strong>
                    <span>상태메시지</span>
                </div>
            </div>
            <div class="profileInfo">
                <span class="tissueCount">500</span>
                <button class="myBlogBtn btn">내 블로그</button>
            </div>
        </div>
        <nav>
            <ul class="rnb">
                <li>
                    <button>홈</button>
                </li>
                <li>
                    <button>회원 정보</button>
                </li>
                <li>
                    <button>결제 관리</button>
                </li>
                <li>
                    <button>차단 목록</button>
                </li>
                <li>
                    <button>관리기록 조회</button>
                </li>
                <li>
                    <button>신고목록 조회</button>
                </li>
                <li>
                    <button>회원정보 검색</button>
                </li>
                <li>
                    <button onclick="">test:패이드 인</button>
                </li>
                <li class="logoutBtn">
                    <button>로그아웃</button>
                </li>
            </ul>
        </nav>
    </header>
    <aside>
        <div class="folder">
            <strong class="minTit">폴더</strong>
            <ul>
                <li class="AllList"><a href="#"><img src="/image/icon_folder.png" alt="아이콘">전체목록(<span>56</span>)</a>
                </li>
                <li><a href="#"><img src="/image/icon_folder.png" alt="아이콘">폴더1의 폴더명</a></li>
                <li><a href="#"><img src="/image/icon_folder.png" alt="아이콘">폴더2의 폴더명</a></li>
                <li><a href="#"><img src="/image/icon_folder.png" alt="아이콘">폴더3의 폴더명</a></li>
                <li><a href="#"><img src="/image/icon_folder.png" alt="아이콘">폴더4의 폴더명</a></li>
                <li><a href="#"><img src="/image/icon_folder.png" alt="아이콘">폴더5의 폴더명</a></li>
                <li><a href="#"><img src="/image/icon_folder.png" alt="아이콘">폴더6의 폴더명</a></li>
                <li><a href="#"><img src="/image/icon_folder.png" alt="아이콘">폴더7의 폴더명</a></li>
                <li><a href="#"><img src="/image/icon_folder.png" alt="아이콘">폴더8의 폴더명</a></li>
                <li><a href="#"><img src="/image/icon_folder.png" alt="아이콘">폴더9의 폴더명</a></li>
                <li><a href="#"><img src="/image/icon_folder.png" alt="아이콘">폴더10의 폴더명</a></li>
            </ul>
            <button class="folderSetBtn"><img src="/image/icon_folder_setting.png" alt="폴더 편집 버튼"></button>
        </div>
    </aside>
    <main>
        <form class="title">
            <button class="backBtn"><img src="/image/btn_arrow.png" alt="뒤로가기 버튼"></button>
            <div>
                <h1>Timeline - main</h1>
                <p><span>24. 03. 25</span></p>
            </div>
            <input class="search_input" type="text" placeholder="검색어를 입력하세요">
            <button class="searchBtn"><img src="/image/btn_search.png" alt="검색 버튼"></button>
            <button class="closeBtn"><img src="/image/btn_close.png" alt="닫기 버튼"></button>
        </form>
        <section> <!-- 각자 개인 페이지들을 section 태그 안에 작성하세요. -->
            <div class="mainProfile">
                <div class="mprofBackground">
                    <img src="/image/icon_no_image_lg.png" alt="사용자 설정 프로필 배경화면 사진">
                </div>
            </div>
            <ul class="tabMenu">
                <li id="trend" class="active">
                    <button onclick="trendBtnClicked()">인기글</button>
                </li>
                <li id="latest">
                    <button onclick="latestBtnClicked()">최신글</button>
                </li>
                <li id="recommended">
                    <button>추천글</button>
                </li>
                <li class="viewBtn">
                    <button onclick="viewBtnClicked()"><img src="/image/btn_view_type.png" alt="보기타입 선택버튼"></button>
                    <ul class="optionBox optionBoxColor">
                        <li><a onclick="blogViewClicked()">Blog view</a></li>
                        <li><a onclick="snsViewClicked()">SNS view</a></li>
                    </ul>
                </li>
            </ul>
            <div style="padding: 20px">
                <ul class="blogList">
                </ul>
                <br><br>
            </div>
            <div id="listEnd"></div>
        </section>
    </main>
</div>
<script>
    let index = parseInt(`[[${index}]]`);
    const range = parseInt(`[[${range}]]`);
    let viewType = `[[${viewType}]]`;
    let contentsType = parseInt(`[[${contentsType}]]`);
    const $tabMenu = document.querySelector(`.tabMenu`);
    let isTitlePhotoChanged = false;
    let isLoading = false;
    const $viewBtn = document.querySelector(".viewBtn");
</script>
<script>

    function setLikeBtnStatus(postCode, likeBtn) {
        fetch(`/post/hasLiked?postCode=${postCode}`)
    }

    function changeLikeIcon(element) {
        var likeImg = element.getElementsByTagName("img")[0];
        var isActive = element.classList.toggle("active");

        if (isActive) {
            likeImg.src = "/image/icon_like_active.png";
        } else {
            likeImg.src = "/image/icon_like.png";
        }

    }

    function likePost(postCode, memberCode) {
        fetch('/post/like', {
            method: 'POST',
            headers: {
                'Content-Type': 'application.json',
            },
            body: JSON.stringify({
                postCode: postCode,
                memberCode: memberCode,
                isPrivate: false,
            }),
        })
            .then(response => response.text())
            .then(result => {
                console.log(result);
            })
            .catch((err) => {
                console.log(err)
            });
    }

</script>
<script id="contentsTemplate" type="text/x-handlebars-template">
    {{#each this}}
    <div class="list_head">
        <div class="prof_photo">

            <img src="{{profile.profileImgPath}}" alt="프로필 사진">
        </div>
        <div>
            <div>
                <strong class="blog_user_name">{{profile.profileNickname}}</strong>
                <span class="blog_user_birth">{{postWriDate}}</span>
            </div>
            <span class="status_msg">{{profile.profileStatmsg}}</span>
        </div>
        <button class="optionBtn"><img src="/image/icon_option.png" alt="글 옵션 버튼"></button>
        <ul class="optionBox">
            <li><a>글 신고하기</a></li>
            <li><a>글 관심없음</a></li>
        </ul>
    </div>
    <div class="list_body">
        <div>
            <strong class="contentTit">{{postTitle}}</strong>
            <div class="contentsTxt">
                <p>
                    {{postText}}
                </p>
            </div>
            <div class="showLikeAndComments">
                <button class="commentsBtn">
                    <img src="/image/icon_comment.png" alt="댓글 버튼 아이콘">
                    <span>{{cmtCount}}</span>
                </button>
                <button class="likeBtn active" onclick="changeLikeIcon(this)">
                    <img src="/image/icon_like.png" alt="좋아요 버튼 아이콘">
                    <span>{{likeCount}}</span>
                </button>
            </div>
        </div>
        <div class="thumbnailPhoto">
            <img src="{{thumbnailPath}}" alt="썸네일 이미지">
        </div>
    </div>
    {{/each}}
</script>
<script src="/js/timeline.js"></script>
<script src="/js/scrollEvent.js"></script>

</body>
</html>